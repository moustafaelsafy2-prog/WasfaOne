<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>مُنشئ الوصفات بالذكاء الاصطناعي</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap');
    body { font-family: 'Cairo', sans-serif; background:#f7f7f9; }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="bg-white shadow-sm">
    <div class="max-w-5xl mx-auto px-4 py-4">
      <h1 class="text-2xl font-bold">مُنشئ الوصفات بالذكاء الاصطناعي</h1>
      <p class="text-gray-600 text-sm">نولّد وصفة كاملة ببنية قياسية عبر الخادم (Netlify Function)</p>
    </div>
  </header>

  <main class="flex-1">
    <div class="max-w-5xl mx-auto px-4 py-6 grid md:grid-cols-3 gap-6">
      <!-- النموذج -->
      <section class="md:col-span-1 bg-white rounded-xl p-4 shadow">
        <h2 class="font-semibold mb-3">مدخلات الوصفة</h2>

        <label class="block text-sm mb-1">نوع الوجبة</label>
        <select id="mealType" class="w-full mb-3 border rounded p-2">
          <option value="الفطور">الفطور</option>
          <option value="الغداء">الغداء</option>
          <option value="العشاء">العشاء</option>
          <option value="سناك">سناك</option>
        </select>

        <label class="block text-sm mb-1">المطبخ</label>
        <select id="cuisine" class="w-full mb-3 border rounded p-2">
          <option value="عربي">عربي</option>
          <option value="متوسطي">متوسطي</option>
          <option value="إيطالي">إيطالي</option>
          <option value="هندي">هندي</option>
          <option value="آسيوي">آسيوي</option>
        </select>

        <label class="block text-sm mb-1">نظام غذائي</label>
        <select id="dietType" class="w-full mb-3 border rounded p-2">
          <option value="منخفض الكربوهيدرات">منخفض الكربوهيدرات</option>
          <option value="كيتو">كيتو</option>
          <option value="متوازن">متوازن</option>
          <option value="نباتي">نباتي</option>
          <option value="خالي من الغلوتين">خالي من الغلوتين</option>
        </select>

        <label class="block text-sm mb-1">الهدف الحراري (سعرة/الحصة)</label>
        <input id="calorieTarget" type="number" min="150" max="1200" step="10" value="500" class="w-full mb-3 border rounded p-2" />

        <label class="block text-sm mb-1">حساسيات شائعة</label>
        <select id="commonAllergy" class="w-full mb-3 border rounded p-2">
          <option value="">لا يوجد</option>
          <option value="مكسرات">مكسرات</option>
          <option value="ألبان">ألبان</option>
          <option value="بيض">بيض</option>
          <option value="مأكولات بحرية">مأكولات بحرية</option>
          <option value="جلوتين">جلوتين</option>
        </select>

        <label class="block text-sm mb-1">حساسيات مخصصة (افصل بفواصل)</label>
        <input id="customAllergy" type="text" placeholder="سمسم، صويا ..." class="w-full mb-3 border rounded p-2" />

        <label class="block text-sm mb-1">تركيز خاص</label>
        <select id="focus" class="w-full mb-4 border rounded p-2">
          <option value="">بدون</option>
          <option value="غني بالبروتين">غني بالبروتين</option>
          <option value="قليل الدهون">قليل الدهون</option>
          <option value="سريع التحضير">سريع التحضير</option>
          <option value="مكونات اقتصادية">مكونات اقتصادية</option>
        </select>

        <button id="generateBtn" class="w-full bg-black text-white rounded-lg py-2 font-semibold disabled:opacity-50">
          توليد الوصفة الآن
        </button>

        <div id="loadingIndicator" class="hidden text-sm text-gray-600 mt-3">... جاري التوليد</div>
        <p id="statusMsg" class="hidden text-sm mt-2"></p>
        <div id="errorMsg" class="hidden text-sm text-red-600 mt-2"></div>
      </section>

      <!-- المخرجات -->
      <section class="md:col-span-2 bg-white rounded-xl p-4 shadow">
        <h2 class="font-semibold mb-4">النتيجة</h2>

        <h3 id="recipeTitle" class="text-xl font-bold mb-2"></h3>

        <div class="grid md:grid-cols-3 gap-4 mb-4">
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">الوقت الإجمالي</div>
            <div id="timeValue" class="text-lg font-semibold">—</div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">الحصص</div>
            <div id="servingsValue" class="text-lg font-semibold">—</div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">السعرات/الحصة</div>
            <div id="caloriesValue" class="text-lg font-semibold">—</div>
          </div>
        </div>

        <div class="grid md:grid-cols-3 gap-4 mb-6">
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">بروتين (غ)</div>
            <div id="proteinValue" class="text-lg font-semibold">—</div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">كربوهيدرات (غ)</div>
            <div id="carbsValue" class="text-lg font-semibold">—</div>
          </div>
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="text-xs text-gray-500">دهون (غ)</div>
            <div id="fatsValue" class="text-lg font-semibold">—</div>
          </div>
        </div>

        <div class="mb-6">
          <h4 class="font-semibold mb-2">المكونات</h4>
          <ul id="ingredientsList" class="list-disc pr-5 space-y-1"></ul>
        </div>

        <div class="mb-6">
          <h4 class="font-semibold mb-2">الخطوات</h4>
          <ol id="preparationSteps" class="list-decimal pr-5 space-y-1"></ol>
        </div>

        <details class="bg-gray-50 rounded-lg p-3">
          <summary class="cursor-pointer font-semibold">Raw JSON</summary>
          <pre id="rawJson" class="text-xs mt-3 overflow-auto"></pre>
        </details>
      </section>
    </div>
  </main>

  <footer class="bg-white border-t">
    <div class="max-w-5xl mx-auto px-4 py-3 text-xs text-gray-500">
      يعمل عبر Netlify Functions و Gemini. لا يتم كشف أي مفاتيح على المتصفح.
    </div>
  </footer>

  <!-- ربط سكربت الواجهة -->
  <script src="/assets/app.js" defer></script>
</body>
</html>
